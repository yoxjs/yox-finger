!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.YoxFinger=e.YoxFinger||{})}(this,function(e){"use strict";function t(e){return Math.sqrt(e.x*e.x+e.y*e.y)}function n(e,t){return e.x*t.x+e.y*t.y}function o(e,o){var i=t(e)*t(o);if(0===i)return 0;var a=n(e,o)/i;return a>1&&(a=1),Math.acos(a)}function i(e,t){return e.x*t.y-t.x*e.y}function a(e,t){var n=o(e,t);return i(e,t)>0&&(n*=-1),180*n/Math.PI}function r(){}function u(e){s=e.utils,s.array.each([h,f,d,v,T,m,y,x,g,b],function(t){e.directive(t,w)})}var c=!1,l=null,p=function(e,t){var n=this;n.el=e,n.startHandler=n.start.bind(n),n.moveHandler=n.move.bind(n),n.endHandler=n.end.bind(n),n.cancelHandler=n.cancel.bind(n),e.addEventListener("touchstart",n.startHandler,c),e.addEventListener("touchmove",n.moveHandler,c),e.addEventListener("touchend",n.endHandler,c),e.addEventListener("touchcancel",n.cancelHandler,c),n.preV={x:l,y:l},n.pinchStartLen=l,n.scale=1,n.isDoubleTap=c,n.rotate=t.rotate||r,n.touchStart=t.touchStart||r,n.multipointStart=t.multipointStart||r,n.multipointEnd=t.multipointEnd||function(){},n.pinch=t.pinch||r,n.swipe=t.swipe||r,n.tap=t.tap||r,n.doubleTap=t.doubleTap||r,n.longTap=t.longTap||r,n.singleTap=t.singleTap||r,n.pressMove=t.pressMove||r,n.touchMove=t.touchMove||r,n.touchEnd=t.touchEnd||r,n.touchCancel=t.touchCancel||r,n.delta=n.last=n.now=n.tapTimeout=n.touchTimeout=n.longTapTimeout=n.swipeTimeout=n.x1=n.x2=n.y1=n.y2=l,n.preTapPosition={x:l,y:l}};p.prototype={start:function(e){var n=this;if(e.touches){n.now=Date.now(),n.x1=e.touches[0].pageX,n.y1=e.touches[0].pageY,n.delta=n.now-(n.last||n.now),n.touchStart(e),n.preTapPosition.x!==l&&(n.isDoubleTap=n.delta>0&&n.delta<=250&&Math.abs(n.preTapPosition.x-n.x1)<30&&Math.abs(n.preTapPosition.y-n.y1)<30),n.preTapPosition.x=n.x1,n.preTapPosition.y=n.y1,n.last=n.now;var o=n.preV,i=e.touches.length;if(i>1){var a={x:e.touches[1].pageX-n.x1,y:e.touches[1].pageY-n.y1};o.x=a.x,o.y=a.y,n.pinchStartLen=t(o),n.multipointStart(e)}n.longTapTimeout=setTimeout(function(){n.longTap(e)}.bind(n),750)}},move:function(e){var n=this;if(e.touches){var o=n.preV,i=e.touches.length,r=e.touches[0].pageX,u=e.touches[0].pageY;if(n.isDoubleTap=c,i>1){var p={x:e.touches[1].pageX-r,y:e.touches[1].pageY-u};o.x!==l&&(n.pinchStartLen>0&&(e.scale=t(p)/n.pinchStartLen,n.pinch(e)),e.angle=a(p,o),n.rotate(e)),o.x=p.x,o.y=p.y}else n.x2!==l?(e.deltaX=r-n.x2,e.deltaY=u-n.y2):(e.deltaX=0,e.deltaY=0),n.pressMove(e);n.touchMove(e),n._cancelLongTap(),n.x2=r,n.y2=u,e.touches.length>1&&e.preventDefault()}},end:function(e){var t=this;if(e.changedTouches){t._cancelLongTap();var n=t;e.touches.length<2&&t.multipointEnd(e),t.touchEnd(e),t.x2&&Math.abs(t.x1-t.x2)>30||t.y2&&Math.abs(t.preV.y-t.y2)>30?(e.direction=t._swipeDirection(t.x1,t.x2,t.y1,t.y2),t.swipeTimeout=setTimeout(function(){n.swipe(e)},0)):t.tapTimeout=setTimeout(function(){n.tap(e),n.isDoubleTap?(n.doubleTap(e),clearTimeout(n.touchTimeout),n.isDoubleTap=c):n.touchTimeout=setTimeout(function(){n.singleTap(e)},250)},0),t.preV.x=0,t.preV.y=0,t.scale=1,t.pinchStartLen=l,t.x1=t.x2=t.y1=t.y2=l}},cancel:function(e){var t=this;clearTimeout(t.touchTimeout),clearInterval(t.tapTimeout),clearInterval(t.longTapTimeout),clearInterval(t.swipeTimeout),t.touchCancel(e)},_cancelLongTap:function(){clearTimeout(this.longTapTimeout)},_swipeDirection:function(e,t,n,o){return Math.abs(e-t)>=Math.abs(n-o)?e-t>0?"Left":"Right":n-o>0?"Up":"Down"},destory:function(){var e=this,t=e.el;t.removeEventListener("touchstart",e.startHandler,c),t.removeEventListener("touchmove",e.moveHandler,c),t.removeEventListener("touchend",e.endHandler,c),t.removeEventListener("touchcancel",e.cancelHandle,c)}};var s=void 0,h="tap",f="longTap",d="singleTap",v="doubleTap",T="swipe",m="pinch",y="rotate",x="pressMove",g="multipointStart",b="multipointEnd",w={attach:function(e){var t=e.el,n=e.name,o=e.node,i=e.instance;e.directives;t.$finger||!function(){var e=new s.Emitter,n=new p(t,{tap:function(t){e.fire(h,t)},longTap:function(t){e.fire(f,t)},singleTap:function(t){e.fire(d,t)},doubleTap:function(t){e.fire(v,t)},swipe:function(t){e.fire(T,t)},pinch:function(t){e.fire(m,t)},rotate:function(t){e.fire(g,t)},pressMove:function(t){e.fire(x,t)},multipointStart:function(t){e.fire(g,t)},multipointEnd:function(t){e.fire(b,t)}});t.$finger={emitter:e,alloy:n}}();var a=i.compileAttr(o.keypath,o.getValue());t.$finger.emitter.on(n,function(e){return a.call(this,new s.Event(e))})},detach:function(e,t){t.$finger.alloy.destroy(),t.$finger.emitter.off(),t.$finger=null}},E="0.0.2";"undefined"!=typeof Yox&&Yox.use&&Yox.use(Router),e.version=E,e.install=u,Object.defineProperty(e,"__esModule",{value:!0})});
